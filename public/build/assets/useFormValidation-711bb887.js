import{r as o}from"./app-1e18f165.js";import{b as T,i as g,p as U}from"./focusSafely-0d0e41b4.js";function G(t){const e=o.useRef(null);return o.useMemo(()=>({get current(){return e.current},set current(a){e.current=a,typeof t=="function"?t(a):t&&(t.current=a)}}),[t])}const M={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},C={...M,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:M,validationErrors:[]},j=o.createContext({}),D="__formValidationState"+Date.now();function H(t){if(t[D]){let{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:u,commitValidation:r}=t[D];return{realtimeValidation:e,displayValidation:a,updateValidation:i,resetValidation:u,commitValidation:r}}return F(t)}function F(t){let{isInvalid:e,validationState:a,name:i,value:u,builtinValidation:r,validate:v,validationBehavior:s="aria"}=t;a&&(e||(e=a==="invalid"));let l=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:C}:null,d=o.useMemo(()=>{if(!v||u==null)return null;let n=Q(v,u);return L(n)},[v,u]);r!=null&&r.validationDetails.valid&&(r=void 0);let c=o.useContext(j),f=o.useMemo(()=>i?Array.isArray(i)?i.flatMap(n=>I(c[n])):I(c[i]):[],[c,i]),[A,O]=o.useState(c),[S,b]=o.useState(!1);c!==A&&(O(c),b(!1));let V=o.useMemo(()=>L(S?[]:f),[S,f]),x=o.useRef(m),[p,E]=o.useState(m),$=o.useRef(m),w=()=>{if(!B)return;y(!1);let n=d||r||x.current;h(n,$.current)||($.current=n,E(n))},[B,y]=o.useState(!1);return o.useEffect(w),{realtimeValidation:l||V||d||r||m,displayValidation:s==="native"?l||V||p:l||V||d||r||p,updateValidation(n){s==="aria"&&!h(p,n)?E(n):x.current=n},resetValidation(){let n=m;h(n,$.current)||($.current=n,E(n)),s==="native"&&y(!1),b(!0)},commitValidation(){s==="native"&&y(!0),b(!0)}}}function I(t){return t?Array.isArray(t)?t:[t]:[]}function Q(t,e){if(typeof t=="function"){let a=t(e);if(a&&typeof a!="boolean")return I(a)}return[]}function L(t){return t.length?{isInvalid:!0,validationErrors:t,validationDetails:C}:null}function h(t,e){return t===e?!0:!!t&&!!e&&t.isInvalid===e.isInvalid&&t.validationErrors.length===e.validationErrors.length&&t.validationErrors.every((a,i)=>a===e.validationErrors[i])&&Object.entries(t.validationDetails).every(([a,i])=>e.validationDetails[a]===i)}function J(...t){let e=new Set,a=!1,i={...M};for(let v of t){var u,r;for(let s of v.validationErrors)e.add(s);a||(a=v.isInvalid);for(let s in i)(u=i)[r=s]||(u[r]=v.validationDetails[s])}return i.valid=!a,{isInvalid:a,validationErrors:[...e],validationDetails:i}}function K(t,e,a){let{validationBehavior:i,focus:u}=t;T(()=>{if(i==="native"&&(a!=null&&a.current)){let l=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";a.current.setCustomValidity(l),a.current.hasAttribute("title")||(a.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(k(a.current))}});let r=g(()=>{e.resetValidation()}),v=g(l=>{var d;e.displayValidation.isInvalid||e.commitValidation();let c=a==null||(d=a.current)===null||d===void 0?void 0:d.form;if(!l.defaultPrevented&&a&&c&&q(c)===a.current){var f;u?u():(f=a.current)===null||f===void 0||f.focus(),U("keyboard")}l.preventDefault()}),s=g(()=>{e.commitValidation()});o.useEffect(()=>{let l=a==null?void 0:a.current;if(!l)return;let d=l.form;return l.addEventListener("invalid",v),l.addEventListener("change",s),d==null||d.addEventListener("reset",r),()=>{l.removeEventListener("invalid",v),l.removeEventListener("change",s),d==null||d.removeEventListener("reset",r)}},[a,v,s,r,i])}function R(t){let e=t.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function k(t){return{isInvalid:!t.validity.valid,validationDetails:R(t),validationErrors:t.validationMessage?[t.validationMessage]:[]}}function q(t){for(let e=0;e<t.elements.length;e++){let a=t.elements[e];if(!a.validity.valid)return a}return null}export{H as $,J as a,K as b,D as c,m as d,G as e,j as f};
