import{r as o,j as e,R as _,_ as j,b}from"./app-1e18f165.js";import{m as w}from"./proxy-a661e4d0.js";import{d as y,a as v,b as E,m as d}from"./chunk-KQ5CH2X7-867295fa.js";import"./create-factory-27ee3d52.js";import"./create-visual-element-9a8f1057.js";import"./accelerated-values-d283ed35.js";import"./useMenuTriggerState-2cd95046.js";import"./SelectionManager-72778fb6.js";import"./FocusScope-34698c61.js";import"./focusSafely-0d0e41b4.js";import"./useCollator-f8b7b7a1.js";import"./getScrollParent-84ae6cc8.js";import"./useFocusable-37bc966c.js";import"./useControlledState-0b6c3be6.js";import"./useLocalizedStringFormatter-6dfb6611.js";import"./useOverlayTrigger-69319b45.js";import"./useOverlayPosition-f27a92c9.js";import"./useResizeObserver-1f814b9f.js";import"./useOverlayTriggerState-20dfbcae.js";import"./useDialog-1281e82d.js";import"./useLabels-bd056dc8.js";import"./VisuallyHidden-6788c411.js";import"./Overlay-e3689e7a.js";import"./index-df311c57.js";import"./chunk-UWE6H66T-10fe3d2c.js";import"./index-4be7962f.js";import"./chunk-GH5E4FQB-d59c17be.js";import"./index-20416e40.js";import"./chunk-MQ3ILONP-ea58cde4.js";import"./mergeRefs-2b78dc7b.js";import"./proxy-1822e291.js";import"./useHover-fbcb60c8.js";import"./chunk-IHO36JMK-b3a8fe4a.js";import"./useTreeState-5f03c581.js";import"./index-f461d43a.js";import"./chunk-XJ3PDX4B-17cba00c.js";import"./chunk-6VC6TS2O-1d40f831.js";import"./chunk-UX7UMZL5-0433f114.js";const S=_.lazy(()=>j(()=>import("./ArchivosCarpeta-eba4f2a3.js"),["assets/ArchivosCarpeta-eba4f2a3.js","assets/app-1e18f165.js","assets/app-bc3ce7a4.css","assets/proxy-a661e4d0.js","assets/create-factory-27ee3d52.js","assets/create-visual-element-9a8f1057.js","assets/accelerated-values-d283ed35.js","assets/index-87e1e468.js","assets/focusSafely-0d0e41b4.js","assets/useControlledState-0b6c3be6.js","assets/index-1246260e.js","assets/index-20416e40.js","assets/chunk-YRZGWF2W-66605d98.js","assets/chunk-UWE6H66T-10fe3d2c.js","assets/index-4be7962f.js","assets/chunk-GH5E4FQB-d59c17be.js","assets/Cell-ac88c214.js","assets/SelectionManager-72778fb6.js","assets/FocusScope-34698c61.js","assets/useCollator-f8b7b7a1.js","assets/getScrollParent-84ae6cc8.js","assets/useFocusable-37bc966c.js","assets/LiveAnnouncer-0a9a6b45.js","assets/useLocalizedStringFormatter-6dfb6611.js","assets/useCheckboxGroupItem-fe2e6ce0.js","assets/useFormValidation-711bb887.js","assets/useFormReset-2e1c4ba3.js","assets/useHover-fbcb60c8.js","assets/chunk-UX7UMZL5-0433f114.js","assets/mergeRefs-2b78dc7b.js","assets/VisuallyHidden-6788c411.js"]));function ce({refreshAccessToken:a}){const[s,u]=o.useState([]),[n,f]=o.useState(null),[x,l]=o.useState(!1),p=async()=>{var c,m;let t=localStorage.getItem("access_token");const i=3599,g=Date.now()>parseInt(i,10);if((!t||g)&&(await a(),t=localStorage.getItem("access_token")),!t){console.error("No se pudo obtener un token vÃ¡lido.");return}try{const r=await b.get("https://internal.meltec.com.co/empresarial/carpetas",{headers:{Authorization:`Bearer ${t}`}});u(r.data.folders||[])}catch(r){if(console.error("Error al listar archivos:",((c=r.response)==null?void 0:c.data)||r.message),((m=r.response)==null?void 0:m.status)===401&&(console.warn("El token podrÃ­a haber expirado. Intentando refrescar..."),await a(),t=localStorage.getItem("access_token"),t))return console.log("Token actualizado, reintentando la peticiÃ³n..."),p()}},h=async t=>{l(!0),f(t),setTimeout(()=>l(!1),2e3)};return o.useEffect(()=>{p()},[]),e.jsxs("div",{className:"flex flex-col items-center justify-center w-full p-4",children:[e.jsxs(y,{children:[e.jsx(v,{className:"border-gray-300 rounded-lg shadow-lg shadow-gray-400 cursor-pointer p-4",children:"ðŸ“ Selecciona una Carpeta Empresarial"}),s.length>0?e.jsx(E,{"aria-label":"Static Actions",children:s.map((t,i)=>e.jsx(d,{onPress:()=>h(t.id),children:t.folder_name},i))}):e.jsx(d,{children:"No se encuentran carpetas disponibles"})]}),n&&e.jsx(o.Suspense,{fallback:e.jsx("p",{className:"text-gray-500",children:"Cargando archivos..."}),children:e.jsx(S,{folderID:n,refreshAccessToken:a})}),x&&e.jsx(w.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-4 border-white"}),e.jsx("p",{className:"text-white mt-2",children:"Cargando..."})]})})]})}export{ce as default};
