import{r as a,j as r}from"./app-1e18f165.js";import{u as w,S as j}from"./notistack.esm-5ab8ec6f.js";import"./clsx.m-1229b3e0.js";function E({refreshAccessToken:f,subFolderId:s}){console.log(s);const[l,c]=a.useState(null);a.useState(null);const[u,d]=a.useState(""),[g,p]=a.useState(!1),n=a.useRef(null),{enqueueSnackbar:t}=w(),m=i=>{const e=i.target.files[0];e&&e.size>0&&(c(e),d(e.name))},b=()=>{c(null),d(""),n.current&&(n.current.value="")},x=()=>{console.log("Toast se está ejecutando"),t("Añade un archivo para realizar esta accion.",{variant:"warning",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2100,style:{fontSize:17,color:"rgb(0, 0, 0)",marginTop:30,background:"rgba(255, 238, 0, 0.52)"}})},v=()=>{console.log("Toast se está ejecutando"),t("No se pudo obtener un token válido.",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2100,style:{fontSize:17,color:"rgb(255, 255, 255)",marginTop:30,background:"rgba(255, 0, 0, 0.52)"}})},k=async()=>{if(!l){x();return}const i=localStorage.getItem("refresh_token");let e;const y=3599,S=Date.now()>parseInt(y,10);if(!e||S)try{if(await f(),e=localStorage.getItem("access_token"),!e){v();return}}catch(o){alert("Error al renovar el token: "+o.message);return}p(!0);const h=new FormData;h.append("file",l);try{const o=await axios.post(`https://internal.meltec.com.co/upload-file/${s}`,h,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${e}`},refresh_token:i});o.data.success?(t(`Archivo subido con éxito: ${o.data.name}`,{variant:"success",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2100,style:{fontSize:17,color:"rgb(0, 0, 0)",marginTop:30,background:"rgba(65, 255, 23, 0.52)"}}),window.location.reload()):t(`Error al subir el archivo: ${o.data.error}`,{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2100,style:{fontSize:17,color:"rgb(0, 0, 0)",marginTop:30,background:"rgba(255, 20, 20, 0.52)"}})}catch(o){console.error("Error al subir el archivo:",o),t("Error al subir el archivo.",{variant:"error",anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:2100,style:{fontSize:17,color:"rgb(0, 0, 0)",marginTop:30,background:"rgba(255, 20, 20, 0.52)"}})}finally{p(!1)}};return r.jsx(j,{maxSnack:3,children:r.jsxs("div",{className:"flex flex-col items-center",children:[r.jsx("input",{type:"file",className:"hidden",onChange:m,ref:n}),r.jsx("button",{onClick:()=>n.current.click(),className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 focus:outline-none mb-3",children:"Seleccionar archivo"}),r.jsx("div",{className:"min-h-[40px] flex items-center justify-center",children:u&&r.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 px-4 py-2 rounded-lg",children:[r.jsx("span",{className:"max-w-[200px] overflow-hidden text-ellipsis whitespace-nowrap text-gray-700",children:u}),r.jsx("button",{onClick:b,className:"px-2 py-1 bg-red-500 text-white rounded-lg hover:bg-red-600 focus:outline-none",children:"X"})]})}),r.jsx("button",{className:`px-6 py-3 text-white rounded-lg mt-3 ${g?"bg-gray-500 cursor-not-allowed":"bg-green-500 hover:bg-green-600"}`,onClick:k,disabled:g,children:"Subir archivo"})]})})}export{E as default};
